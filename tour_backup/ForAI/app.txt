from flask import Flask, render_template, request, jsonify, url_for, redirect
import os
import re
import io
from datetime import date, datetime
import mysql.connector
import uuid

app = Flask(__name__)

# Database connection
def get_db_connection():
    return mysql.connector.connect(
        host="127.0.0.1",
        port="3306",
        user="root",
        password="0821411984",
        database="booking_system"
    )

def load_data_from_file(filename):
    try:
        script_dir = os.path.dirname(os.path.abspath(__file__))
        file_path = os.path.join(script_dir, filename)
        
        with open(file_path, 'r') as f:
            data = [line.strip() for line in f.readlines() if line.strip()]
        
        return data
    except Exception as e:
        print(f"Error loading file {filename}: {str(e)}")
        return []

@app.route("/")
def index():
    return render_template("P00_login.html")

@app.route("/home")
def home():
    return render_template("P0_home.html")

@app.route("/home_tour_and_motorbike_rental")
def tour_and_motorbike_rental():
    # Load room data from file
    rooms = load_data_from_file('static/config/room.txt')
    today = date.today().isoformat()  # YYYY-MM-DD
    return render_template('P1_home_tour_and_motorbike_rental.html', room=rooms, today=today)

@app.route("/home_transfer")
def home_transfer():
    return render_template("P2_home_transfer.html")

@app.route("/login")
def login():
    return render_template("P00_login.html")

if __name__ == "__main__":   
    app.run(debug=True)