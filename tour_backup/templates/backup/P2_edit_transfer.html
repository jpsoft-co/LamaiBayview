<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/P1P2_style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/main.css') }}">
    <title>Edit Home Transfer Booking</title>
    <style>
        .status-paid {
            color: #4CAF50;
            font-weight: 600;
        }
        
        .status-unpaid {
            color: #f44336;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <!-- Wrapper -->
    <div id="wrapper">
        <!-- Header -->
        <header id="header">
            <h1>
                <a href="{{ url_for('home') }}">Lamai Bayview Boutique Resort</a>
            </h1>
            <nav class="main">
                <ul>
                    <li class="menu">
                        <a class="fa-bars" href="#menu">Menu</a>
                    </li>
                </ul>
            </nav>
        </header>

        <!-- Menu -->
        <section id="menu">
            <!-- Links -->
            <section>
                <ul class="links">
                    <li>
                        <a href="{{ url_for('tour_and_motorbike_form') }}">
                            <h3 style="color: #000000;">Tour & Motorbike Rental</h3>
                            <p>view all bookings</p>
                        </a>
                    </li>
                    <li>
                        <a href="home_transfer_form">
                            <h3 style="color: #000000;">Home Transfer</h3>
                            <p>click for view the form</p>
                        </a>
                    </li>
                </ul>
            </section>

            <!-- Actions -->
            <section>
                <a href="{{ url_for('login') }}" 
                class="card-btn" 
                style="display: flex; justify-content: center; align-items: center; height: 40px;">
                Log out
                </a>
            </section>
        </section>
    </div>

    <div class="container">
        <div class="form-wrapper">
            <div class="gold-accent"></div>
            <div class="form-header">
                <h1>Lamai Bayview Boutique Resort</h1>
                <p>Edit Home Transfer Booking</p>
            </div>
            
            <div class="form-body">
                <form action="{{ url_for('update_transfer_booking') }}" method="POST">
                    <input type="hidden" name="booking_no" value="{{ booking.booking_no }}">
                    
                    <div class="booking-info">
                        <h3>Booking #{{ booking.booking_no }}</h3>
                        <p>Original Booking Date: {{ booking.booking_date }}</p>
                    </div>
                    
                    <div class="form-section">
                        <h4>Customer Information</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="name">Name</label>
                                <input type="text" class="form-control" id="name" name="name" value="{{ booking.customer_name }}" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="surname">Surname</label>
                                <input type="text" class="form-control" id="surname" name="surname" value="{{ booking.customer_surname }}" required>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h4>Transfer Details</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Transfer Type</label>
                                <div class="radio-group">
                                    <label class="radio-option">
                                        <input type="radio" name="transferType" value="departure" {% if booking.departure %}checked{% endif %}>
                                        <span class="radio-label">Departure</span>
                                    </label>
                                    <label class="radio-option">
                                        <input type="radio" name="transferType" value="arrivals" {% if booking.arrivals %}checked{% endif %}>
                                        <span class="radio-label">Arrivals</span>
                                    </label>
                                </div>
                                <input type="hidden" id="departure" name="departure" value="{% if booking.departure %}yes{% endif %}">
                                <input type="hidden" id="arrivals" name="arrivals" value="{% if booking.arrivals %}yes{% endif %}">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="place_from">From</label>
                                <input type="text" class="form-control" id="place_from" name="place_from" value="{{ booking.place_from }}" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="place_to">To</label>
                                <input type="text" class="form-control" id="place_to" name="place_to" value="{{ booking.place_to }}" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="detail">Detail</label>
                                <input type="text" class="form-control" id="detail" name="detail" value="{{ booking.detail }}">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="date">Travel Date</label>
                                <input type="date" class="form-control" id="date" name="date" value="{{ booking.travel_date }}" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="time">Pickup Time</label>
                                <input type="time" class="form-control" id="time" name="time" value="{{ booking.pickup_time }}">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="persons">Quantity (Persons)</label>
                                <input type="number" class="form-control" id="persons" name="persons" value="{{ booking.quantity }}" min="1" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="price">Price Per Person (THB)</label>
                                <input type="number" class="form-control" id="price" name="price" value="{{ booking.price }}" min="0" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="total">Total Received (THB)</label>
                                <input type="number" class="form-control" id="total" name="total" value="{{ booking.received }}" min="0" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="status">Payment Status</label>
                                <select class="form-control" id="status" name="status" required>
                                    <option value="paid" {% if booking.payment_status == 'paid' %}selected{% endif %}>Paid</option>
                                    <option value="unpaid" {% if booking.payment_status == 'unpaid' %}selected{% endif %}>Unpaid</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label" for="staffName">Staff Name</label>
                                <input type="text" class="form-control" id="staffName" name="staffName" value="{{ booking.staff_name }}" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label" for="driverName">Driver Name</label>
                                <input type="text" class="form-control" id="driverName" name="driverName" value="{{ booking.driver_name }}">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-actions" style="text-align: center; margin-top: 30px;">
                        <button type="submit" class="card-btn">Save Changes</button>
                        <a href="{{ url_for('home_transfer_form') }}" class="card-btn">Cancel</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="{{ url_for('static', filename='assets/js/jquery.min.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/browser.min.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/breakpoints.min.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/util.js') }}"></script>
    <script src="{{ url_for('static', filename='assets/js/main.js') }}"></script>
    <script>
        // Handle transfer type selection
        const transferTypeRadios = document.querySelectorAll('input[name="transferType"]');
        const departureField = document.getElementById('departure');
        const arrivalsField = document.getElementById('arrivals');

        transferTypeRadios.forEach(radio => {
            radio.addEventListener('change', function() {
                if (this.value === 'departure') {
                    departureField.value = 'yes';
                    arrivalsField.value = '';
                } else if (this.value === 'arrivals') {
                    departureField.value = '';
                    arrivalsField.value = 'yes';
                }
            });
        });

        // Calculate total when price or persons change
        const priceInput = document.getElementById('price');
        const personsInput = document.getElementById('persons');
        const totalInput = document.getElementById('total');
        
        function calculateTotal() {
            const price = parseFloat(priceInput.value) || 0;
            const persons = parseInt(personsInput.value) || 0;
            const total = price * persons;
            totalInput.value = total.toFixed(2);
        }
        
        if (priceInput && personsInput && totalInput) {
            priceInput.addEventListener('input', calculateTotal);
            personsInput.addEventListener('input', calculateTotal);
        }
    </script>
</body>
</html>